# README: Radiation Effects on Protoplanetary Disks

## Table of Contents

1. [Introduction](#introduction)
2. [Data Sources](#data-sources)
3. [File Structure](#file-structure)
4. [Focus for This Summer](#focus-for-this-summer)
5. [Goodman Data Cleanup Process](#goodman-data-cleanup-process)
   - [1. Goodman Pipeline](#1-goodman-pipeline)
   - [2. Wavelength Solution](#2-wavelength-solution)
   - [3. Normalization](#3-normalization)
   - [4. Spectral Type Classification](#4-spectral-type-classification)


  - [5. H-alpha Measurement](#5-h-alpha-measurement)
  - [6. Radial Velocity](#6-radial-velocity)
  - [7. Accretor Fraction Calculation](#7-accretor-fraction-calculation)

6. [Goodman\_Process Details](#goodman_process-details)

## Introduction

We investigate the width and height of the H-alpha emission line from young stars to evaluate the effects of radiation from O-type stars and supernova remnants on protoplanetary disks. By comparing accretor fractions across regions with varying FUV radiation levels (G₀) and different ages, we aim to verify that radiation shortens the T-Tauri stage of young star formation. [Previous research paper](https://doi.org/10.3847/1538-4357/ab6333)

---

## Data Sources

- **Goodman Spectrography**
- **Chiron Data** *(unpublished)*
- **Previous Research**: [Yep & White (2020)](https://doi.org/10.3847/1538-4357/ab6333)

---

## File Structure

### CHIRON:

Contains Chiron FITS data files.

### Goodman\_Process:

Processed Goodman FITS data.

### Main\_Function:

All functions and codes used for data processing and analysis.

### data:

Summary data combining Chiron and Goodman datasets.

---

## Focus for This Summer

**Goodman Raw Data**

- Check the proposal and Goodman\_Observing\_Log.xlsx for detailed observation information.

---

## Goodman Data Cleanup Process

The Goodman Data Cleanup Process involves the following steps:

1. [Goodman Pipeline](#1-goodman-pipeline)
2. [Wavelength Solution](#2-wavelength-solution)
3. [Normalization](#3-normalization)
4. [Spectral Type Classification](#4-spectral-type-classification)
5. [H-alpha Measurement](#5-h-alpha-measurement)
6. [Radial Velocity](#6-radial-velocity)
7. [Accretor Fraction Calculation](#7-accretor-fraction-calculation)

### [1. Goodman Pipeline](https://soardocs.readthedocs.io/projects/goodman-pipeline/en/latest/)

- Install the Goodman Pipeline (Python) on Ubuntu via AWS.
- Run the pipeline using `redccd` and `redspec` ([Pipeline Documentation](https://soardocs.readthedocs.io/projects/goodman-pipeline/en/latest/)).

**Issue**: Wavelength calibration failure.

- **Solution**: Apply a custom wavelength solution to the e-files generated by the pipeline.

### 2. Wavelength Solution

**Problem**: Pipeline cannot find the reference lamp.

- **Fix**: Use the `--reference file` parameter to specify the file path.
- Update the header in **goodman\_comp\_2100\_650\_GG455\_HgNeAr\_NEW\.fits**:
  - Add `Ne_lamp` = `True`, others = `False`.
  - Leave `WAVEMOD` blank.

#### Key Files

- **ecfzst\_0057\_CG4\_8\_comp\_165.98-175.83.fits**: Comparison FITS file containing Ne lamp and star flux data.
- **NeLines.dat**: Authentic Ne lamp data from National Lab.
- **goodman\_comp\_2100\_650\_GG455\_HgNeAr\_NEW\.fits**: Reference lamp file with Hg and Ar lines missing.
- **ecfzst\_0056\_CG4\_8.fits**: Target star file (CG4\_8).

#### Method

1. Define the x-axis pixel point of **ecfzst\_0057\_CG4\_8\_comp\_165.98-175.83.fits** using Gaussian modeling to find flux centers.
2. Match x-axis pixel points to **NeLines.dat** to calibrate data.
3. Apply the calibrated function to the target star file.
4. Check whether all the Neon line is detected after running the code: efile/wfun\_check folder

### Code

Main\_Function / WavelengthSolution.ipynb

---

### 3. Normalization

- Remove molecular bands/emission line/absorption line and fit the spectrum.
  ### Problem
  Even though we did the Spectral Type Classification, we failed to normalized it based on our results before. we don't know whether the star is K star or M star, and we are not sure which way to normalize it is better.
- K star normalization: cut the K standard star emission line and absorption line, use Gauss curve to fit the line. 
- M star normalization: cut the M stars typical molecular band and use Gauss curve to fit the line.([referece paper for M star molecular band](https://link.springer.com/article/10.1134/S1063772914110043))
  ### **Solution**
- Apply two normalization methods to all the files and do the comparison
- picture path: Final normalization file for all stars: norm\_final0 (I did GoodmanNormBest but seem like Dr. Yep add something new to it so we have norm\_final0)
### 4. Spectral Type Classification

* Stack standard and target star spectra to estimate spectral types by looking at it.
* code folder: Main_Function/evaluate_SpT
* result recorded: Standard_star.xlsx/sheet3, GoodmanSpecTypes.dat (I do feel .dat is a better choice compare to excel when there are tones of data to record)

### 5. H-alpha Measurement
* Use python package to detect the peak, and measure the width of the H_alpha peak at 10% height(Reference Paper: [White & Russel J. 2003](https://iopscience.iop.org/article/10.1086/344673))
- Execute **HaEmission.ipynb**.

### 6. Radial Velocity
* I have no idea how we calculate the radial velocity, seems very complicated. Dr. Yep run her code to calculate the velocity for more than a week. 
- Use **RadialVelocities.ipynb**.

### 7. Accretor Fraction Calculation

* When the H_alpha peak width is larger than 270 km/s, we recognize it as a young star with disk.
* select all the star with protoplanery disks review and analyze in **RV\_comparasion.xlsx**.

---

## Goodman\_Process Details

### Goodman\_Observing\_Log.xlsx

- **Recording Log**: Includes star magnitudes (V).
- **Summary**: Use `read_V` function.
- **Selection**: Selector for K and M solutions (superseded by GoodmanNormBest).
  - Records in **GoodmanSpecTypes.dat**.

### RV\_comparasion.xlsx

- **Original**: Contains:
  - **GoodmanRV.dat**: Raw radial velocity data.
  - **H\_alpha Measurement**.
  - **GoodmanRVs\_CHIRON.dat**: Cross-check RV data from different telescopes.
  - **CG\_rvs.dat**: Chiron radial velocity data.
  - **CGs\_Ha.dat**: Chiron H-alpha data.
- **Sheet1**: Filter discarded stars (H-alpha width > 270).
- **Accretor**: Summary used for graphing (**data\_graph.ipynb**).
- **Changes**: Final summary for plotting accretor fraction.

### Standard\_star.xlsx

- **Sheet1-4**: Spectrum type estimates and discarded stars.
- **Standard Folder**: Standard files for plotting and spectral type comparison.

### Raw Data Folders

- **Day1, Day2, Day3, Special**: Raw FITS files from Goodman.
  - **RED**: Pipeline-reduced data (failed wavelength solution).
  - **Wfun**: Wavelength solution applied.
  - **Norm**: Normalized data (final files in GoodmanNormBest).

---

### **Special cases:** 

**Issue:** Multiple stars are detected in the spectrum.&#x20;

**Solution:** Use Python to segment the data into two distinct files, each containing one specific peak. File location: Goodman\_process/special."

